{% extends 'base.html' %}
{% load static %}

{% comment %}
{ ------------------- ì´ 15ê°œ ë°ì´í„° -------------------------
'store_name': ì‹ë‹¹ì´ë¦„, => ë² ì´ìŠ¤
'store_score': í‰ì , => ë² ì´ìŠ¤
'store_brief_intro': ê°€ê²Œ ê°„ë‹¨ ì†Œê°œ, => ë² ì´ìŠ¤
'store_intro': ê°€ê²Œ ì†Œê°œ, => ìƒì„¸
'store_imgs': ê°€ê²Œ ì‚¬ì§„ë“¤, => ë² ì´ìŠ¤
'store_category': ê°€ê²Œ ì—…ì¢…, => ë² ì´ìŠ¤
'store_address': ê°€ê²Œ ì£¼ì†Œ, => í™ˆ, ìƒì„¸
'store_way_to_come': ê°€ê²Œ ì˜¤ì‹œëŠ”ê¸¸, => ìƒì„¸
'store_operating_time': ê°€ê²Œ ì˜ì—… ì‹œê°„, => ìƒì„¸
'store_today_operating_time': ì˜¤ëŠ˜ ë§¤ì¥ ì˜ì—… ì‹œê°„, => í™ˆ
'store_phone_number': ê°€ê²Œ ì „í™”ë²ˆí˜¸, => ìƒì„¸
'store_facility_detail': ê°€ê²Œ í¸ì˜ ì‹œì„¤ ì •ë³´, => í™ˆ
'store_main_menu': ê°€ê²Œ ëŒ€í‘œë©”ë‰´, => í™ˆ, ë©”ë‰´
'store_drinks': ê°€ê²Œ ìŒë£Œ/ì£¼ë¥˜, => ë©”ë‰´
'store_homepage': ê°€ê²Œ í™ˆí˜ì´ì§€, => ìƒì„¸
}
{% endcomment %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/bakeries/shop_home.css' %}">
{% endblock css %}

{% block content %}
<main class='container mb-5'>
  {% comment %} ë¹µì§‘ ìƒì„¸ í˜ì´ì§€ ê³µí†µ ì •ë³´ {% endcomment %}
  <section>
    {% comment %} ë°°ê²½ ì´ë¯¸ì§€ {% endcomment %}
    <article class='background'>
      <img src="{% static 'img/bakeries/background_img.jpg' %}" alt="" class='background-img'>
      <div class='background-cover'></div>
    </article>
    {% comment %} ë¹µì§‘ ê¸°ë³¸ ì •ë³´ {% endcomment %}
    <article class='mt-3 ms-3'>
      {% comment %} ë¹µì§‘ ìƒí˜¸ëª…/í‰ì  {% endcomment %}
      <div class='d-flex align-items-center'>
        <h3 class='me-3 fw-bolder'>{{ store_data.store_name }}</h3>
        <p class='shop-score'>{{ store_data.store_score }}</p>
      </div>
      {% comment %} ë¹µì§‘ ê°„ë‹¨ ì†Œê°œê¸€/ë¹µì§‘ ì—…ì¢…/ë¦¬ë·° ì‘ì„± ë²„íŠ¼ {% endcomment %}
      <div class='d-flex align-items-center justify-content-between'>
        <div>
          <p class='mb-1'>{{ store_data.store_brief_intro }}</p>
          <p class='my-0 text-muted'>{{ store_data.store_category }}</p>
        </div>
        <form action="{% url 'reviews:create' shop_id %}" class='m-0'>
          <button class='review-create-btn' type="submit">
            <i class="bi bi-pencil"></i>
            <p class='mb-0 mt-1'>ë¦¬ë·° ì‘ì„±</p>
          </button>
          <input type="hidden" name="shop_name" value='{{ store_data.store_name }}'>
        </form>
      </div>
    </article>
  </section>

  {% comment %} í™ˆ/ë©”ë‰´/ìƒì„¸/ë¦¬ë·° íƒ­ ë²„íŠ¼ {% endcomment %}
  <section class='row row-cols-4 mt-5 border-top tap-btns'>
    <div class='col'>
      <a href="" class='active' data-order='0'>í™ˆ</a>
    </div>
    <div class='col'>
      <a href="" data-order='1'>ë©”ë‰´</a>
    </div>
    <div class='col'>
      <a href="" data-order='2'>ìƒì„¸</a>
    </div>
    <div class='col'>
      <a href="" data-order='3'>
        ë¦¬ë·°
        <span class="badge rounded-pill text-bg-secondary">{{ reviews.count }}</span>
      </a>
    </div>
  </section>

  {% comment %} í™ˆ/ë©”ë‰´/ìƒì„¸/ë¦¬ë·° ê° íƒ­ë³„ ìƒì„¸ ì •ë³´ {% endcomment %}
  <section class='tap-infos py-3 px-4'>

    {% comment %} 1) home íƒ­ {% endcomment %}
    <article class='active'>
      {% comment %} ì£¼ì†Œ {% endcomment %}
      <div class='d-flex py-2 border-bottom'>
        <i class="bi bi-geo-alt"></i>
        <span>{{ store_data.store_address.0 }}</span>
      </div>
      {% comment %} ì˜¤ëŠ˜ ë§¤ì¥ ì˜ì—… ì‹œê°„ {% endcomment %}
      <div class='d-flex py-2 border-bottom'>
        <i class="bi bi-clock"></i>
        <span class='open me-2'>{{ store_data.store_today_operating_time.2 }}</span>
        <span>{{ store_data.store_today_operating_time.1 }}</span>
      </div>
      {% comment %} ê°€ê²Œ í¸ì˜ ì‹œì„¤ ì •ë³´ {% endcomment %}
      <div class='d-flex py-2'>
        <i class="bi bi-shop"></i>
        <div class='facility_details'>
          {% for facility_detail in store_data.store_facility_detail %}
          <span>{{ facility_detail }}</span>
          <span>/</span>
          {% endfor %}
        </div>
      </div>
      {% comment %} ë¹µì§‘ ì´ë¯¸ì§€(carousel) {% endcomment %}
      <h5 class='mt-4 fw-bold'>ë°©ë¬¸ì ì‚¬ì§„</h5>
      {% comment %} <img src="{% static 'img/bakeries/visitor_imgs_bg.png' %}" alt=""> {% endcomment %}
      <div class='carousel-background'>
        <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="true">
          <div class="carousel-indicators">
            {% for img_url in store_data.store_imgs %}
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="{{ forloop.counter0 }}"
              aria-label="Slide {{ forloop.counter0 }}"></button>
            {% endfor %}
          </div>
          <div class="carousel-inner">
            {% for img_url in store_data.store_imgs %}
            <div class="carousel-item">
              <img src="{{ img_url }}" alt="" class="d-block w-100 h-100">
            </div>
            {% endfor %}
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>
      </div>
    </article>

    {% comment %} 2) menu íƒ­ {% endcomment %}
    <article>
      {% comment %} ë©”ì¸ ë©”ë‰´ {% endcomment %}
      <div class='mb-4'>
        <h5 class='fw-bold'>ë©”ì¸ ë©”ë‰´</h5>
        {% for menu in store_data.store_main_menu %}
        <div class='row py-2 border-bottom g-1'>
          <div class='col-1'>ğŸ¥</div>
          <div class='col-9 main-menus'>{{ menu.0 }}</div>
          <div class='col-2 text-end'>{{ menu.1 }}ì›</div>
        </div>
        {% endfor %}
      </div>
      {% comment %} ìŒë£Œ ë©”ë‰´ {% endcomment %}
      <div>
        <h5 class='fw-bold'>ìŒë£Œ</h5>
        {% for drink in store_data.store_drinks %}
        <div class='row py-2 border-bottom g-1'>
          <div class='col-1'>ğŸ¥¤</div>
          <span class='col-11 drinks'>{{ drink }}</span>
        </div>
        {% empty %}
        <p class='text-muted'>ì—†ìŒ</p>
        {% endfor %}
      </div>
    </article>

    {% comment %} 3) detail íƒ­ {% endcomment %}
    <article>
      {% comment %} ê°€ê²Œ ì†Œê°œ {% endcomment %}
      <div class='mb-4'>
        <h5 class='fw-bold'>ì†Œê°œ</h5>
        <p class='m-0'>{{ store_data.store_intro }}</p>
      </div>
      {% comment %} ê°€ê²Œ ì£¼ì†Œ {% endcomment %}
      <div class='mb-4'>
        <h5 class='fw-bold'>ì£¼ì†Œ</h5>
        <p class='m-0'>{{ store_data.store_address.0 }}</p>
        <div class='text-muted'>
          <span>{{ store_data.store_address.1 }}</span>
          <span>{{ store_data.store_address.2 }}</span>
        </div>
      </div>
      {% comment %} ê°€ê²Œ ì˜ì—… ì‹œê°„ {% endcomment %}
      <div class='mb-4'>
        <h5 class='fw-bold'>ì˜ì—… ì‹œê°„</h5>

        <table>
          {% for day, time in store_data.store_operating_time %}
          <tr>
            <td class='even pe-2 pb-2'>{{ day }}</td>
            <td class='pe-2 pb-2'>{{ time }}</td>
          </tr>

          {% endfor %}
        </table>
        </div>
      </div>
      {% comment %} ê°€ê²Œ ì „í™”ë²ˆí˜¸ {% endcomment %}
      <div class='mb-4'>
        <h5 class='fw-bold'>ì „í™”ë²ˆí˜¸</h5>
        <p class='m-0'>
          <i class="bi bi-telephone"></i>
          <span>{{ store_data.store_phone_number }}</span>
        </p>
      </div>
      {% comment %} ê°€ê²Œ í™ˆí˜ì´ì§€ {% endcomment %}
      <div class='mb-4'>
        <h5 class='fw-bold'>í™ˆí˜ì´ì§€</h5>
        {% for homepage in store_data.store_homepage %}
          <i class="bi bi-house"></i>
          <a href='{{ homepage }}'>{{ homepage }}</a>
        {% empty %}
          <p>ì—†ìŒ</p>
        {% endfor %}
      </div>
    </article>

    {% comment %} 4) review íƒ­ {% endcomment %}
    <article>
      <div class='mx-auto pb-5 border-bottom' style='width: 440px;'>
        <h5 class='fw-bold'>ë°©ë¬¸ì ë¦¬ë·°</h5>
        <div class='text-center'>
          <span>ğŸ¥¨ 
            <span class='fw-bold'>{{ store_data.store_name }}</span>
            ì˜ ì†Œì¤‘í•œ ë¦¬ë·°
          </span>
          <span class='fs-3 fw-bold' style='color:orange;'>{{ reviews.count }}</span>
        </div>
      </div>
      {% for review in reviews %}
      <div class='review-block border-bottom mx-auto py-3 px-2'>
        <p class='fw-bold my-1'>{{ review.user }}</p>
        <div class='d-flex justify-content-between'>
          <form action="" class='my-1'>
            <button type="submit" class='like-btn'>
              {% if request.user in review.like_users %}
              <i class="bi bi-heart-fill"></i>
              {% else %}
              <i class="bi bi-heart"></i>
              {% endif %}
              <span>{{ review.like_users.count }}</span>
            </button>
          </form>
          <p class='text-muted my-1'>{{ review.visited_at }}</p>
        </div>
        <img src="{{ review.image.url }}" alt="" class='review-img rounded-4'>
        <p class="text-break my-1 px-2">{{ review.content|truncatechars:200 }}</p>
        <a href="{% url 'reviews:detail' review.pk %}" class='d-block ps-2 py-1 review-detail'>ìì„¸íˆ</a>
      </div>
      {% empty %}
      <p class='text-center py-3'>ì‘ì„±ëœ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤</p>
      {% endfor %}
    </article>
  </section>
</main>
{% endblock content %}

{% block js %}
<script src="{% static 'js/bakeries/shop_home.js' %}"></script>
{% endblock js %}